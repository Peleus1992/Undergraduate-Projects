<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">

<title>Hardware Abstraction Layer: micro-common.h File Reference</title>

<LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">

</head><body>

<table border="0" cellspacing="0" cellpadding="0"  width=100%>

<tr>

<td><img src="ST_Logo.gif"></td>

<td> <div class="qindex">

<a class="qindex" href="index.html">Home</a>&nbsp;

 | &nbsp;<a class="qindex" href="modules.html">Modules</a>&nbsp;

 | &nbsp;<a class="qindex" href="annotated.html">Data Structures</a>&nbsp;

 | &nbsp;<a class="qindex" href="files.html">File List</a>&nbsp;

 | &nbsp;<a class="qindex" href="globals.html">Index</a></div>

</td>

</table>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>micro-common.h File Reference</h1>
<p>Utility and convenience functions for STM32W108 microcontroller, common to both the full and minimal hal. See <a class="el" href="group__micro.html">Micro</a> for documentation.  
<a href="#_details">More...</a></p>

<p><a href="cortexm3_2micro-common_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__micro.html#ga27b541c1f900a25d980c902ee5a30721">PORTA_PIN</a>(y)&nbsp;&nbsp;&nbsp;((0&lt;&lt;3)|y)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Some registers and variables require indentifying GPIO by a single number instead of the port and pin. This macro converts Port A pins into a single number.  <a href="group__micro.html#ga27b541c1f900a25d980c902ee5a30721"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__micro.html#ga3d53d811ca29690c1c5c8b8adbc534ce">PORTB_PIN</a>(y)&nbsp;&nbsp;&nbsp;((1&lt;&lt;3)|y)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Some registers and variables require indentifying GPIO by a single number instead of the port and pin. This macro converts Port B pins into a single number.  <a href="group__micro.html#ga3d53d811ca29690c1c5c8b8adbc534ce"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__micro.html#ga9c6bfc2e884b3b9f46732f3990d4d6af">PORTC_PIN</a>(y)&nbsp;&nbsp;&nbsp;((2&lt;&lt;3)|y)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Some registers and variables require indentifying GPIO by a single number instead of the port and pin. This macro converts Port C pins into a single number.  <a href="group__micro.html#ga9c6bfc2e884b3b9f46732f3990d4d6af"></a><br/></td></tr>
<tr><td colspan="2"><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="group__iar.html#gae712ac7a6479b38bdbb3286e80b72049">int8u</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__micro.html#gafddf1f4a9c9eff790d56c8950c1fb0ad">StStatus</a></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__micro.html#ga8a39a028776dc2065aa3f02c2a1fd1d6">halInternalResetWatchDog</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Resets the watchdog timer. This function is pointed to by the macro <a class="el" href="group__iar.html#ga12ef4b3c98231a44d2c2cd3b04cec5a4">halResetWatchdog()</a>.  <a href="group__micro.html#ga8a39a028776dc2065aa3f02c2a1fd1d6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__micro.html#gab8c93b98c927cae04fd70c5446c0a310">halGpioConfig</a> (<a class="el" href="group__iar.html#ga2ba8e0357fdc7b7a450e6893ed81e8e3">int32u</a> io, <a class="el" href="group__iar.html#ga2ba8e0357fdc7b7a450e6893ed81e8e3">int32u</a> config)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Configure an IO pin's operating mode.  <a href="group__micro.html#gab8c93b98c927cae04fd70c5446c0a310"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__micro.html#ga4173faf01f05eb52ca815bec94193818">halInternalCalibrateSlowRc</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calibrates the internal SlowRC to generate a 1024 Hz (1kHz) clock.  <a href="group__micro.html#ga4173faf01f05eb52ca815bec94193818"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__micro.html#gad9b2f11a69544770078feaa71b6a3d0d">halInternalCalibrateFastRc</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calibrates the internal FastRC to generate a 12Mhz clock.  <a href="group__micro.html#gad9b2f11a69544770078feaa71b6a3d0d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__micro.html#ga27b7b259d7a8129736034ac6bfb00142">halInternalSetRegTrim</a> (<a class="el" href="group__iar.html#ga7670a4e8a07d9ebb00411948b0bbf86d">boolean</a> boostMode)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets the trim values for the 1.8V and 1.2V regulators based upon manufacturing configuration.  <a href="group__micro.html#ga27b7b259d7a8129736034ac6bfb00142"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__iar.html#ga409a5c4bea6981c30b308684efa33f6f">int16u</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__micro.html#ga9ff06122c0353b3643a5f04072f64472">stMeasureVddSlow</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Takes a slow ADC measurement of VDD_PADS in millivolts. Due to the conversions performed, this function takes slightly under 3.2ms with a variation across successive conversions approximately +/-2mv of the average conversion.  <a href="group__micro.html#ga9ff06122c0353b3643a5f04072f64472"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__iar.html#ga409a5c4bea6981c30b308684efa33f6f">int16u</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__micro.html#ga6255750f758f40b247bbbe28019ee07f">stMeasureVddFast</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Takes a fast ADC measurement of VDD_PADS in millivolts. Due to the conversions performed, this function takes slightly under 150us with a variation across successive conversions approximately +/-20mv of the average conversion.  <a href="group__micro.html#ga6255750f758f40b247bbbe28019ee07f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__micro.html#ga8d943bddd6a0281e18a40b002940e622">halCommonCalibratePads</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calibrates the GPIO pads. This function is called from within the stack and HAL at appropriate times.  <a href="group__micro.html#ga8d943bddd6a0281e18a40b002940e622"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__micro.html#ga35ddce6a5df4800dd1980735c59c6b2c">halCommonCheckXtalBiasTrim</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function is intended to be called periodically, from the stack and application, to check the XTAL bias trim is within appropriate levels and adjust if not. This function is *not* designed to be used before <a class="el" href="group__micro.html#gae47dcfa6256c2dd58e2a451e6b1411c6" title="Switches to running off of the 24MHz crystal, including changing the CPU to be 24MHz...">halInternalSwitchToXtal()</a> has been called.  <a href="group__micro.html#ga35ddce6a5df4800dd1980735c59c6b2c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__micro.html#gae47dcfa6256c2dd58e2a451e6b1411c6">halInternalSwitchToXtal</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Switches to running off of the 24MHz crystal, including changing the CPU to be 24MHz (FCLK sourced from SYSCLK). The switch function will respect the BIASTRIM HI and LO flags and adjust bias trim until appropriate crystal biasing is used. This function is called from within the stack and HAL at appropriate times.  <a href="group__micro.html#gae47dcfa6256c2dd58e2a451e6b1411c6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__micro.html#gaebd4d106a0a42931460824b959ac32ee">halInternalSearchForBiasTrim</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Search for optimal 24MHz crystal bias trim, assuming no valid prior value. This function is typically called during initialization of the microcontroller.  <a href="group__micro.html#gaebd4d106a0a42931460824b959ac32ee"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__micro.html#ga3b180f12872a4b39217327000947fe8d">halCommonDelayMilliseconds</a> (<a class="el" href="group__iar.html#ga409a5c4bea6981c30b308684efa33f6f">int16u</a> ms)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Blocks the current thread of execution for the specified amount of time, in milliseconds.  <a href="group__micro.html#ga3b180f12872a4b39217327000947fe8d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__micro.html#ga051d6e844d4db15cfc70f5bf62b496e6">halSleepWithOptions</a> (<a class="el" href="group__micro.html#gaf1ad4bf3c523627d4b6f730b2e667968">SleepModes</a> sleepMode, <a class="el" href="group__iar.html#ga2ba8e0357fdc7b7a450e6893ed81e8e3">int32u</a> gpioWakeBitMask)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Puts the microcontroller to sleep in a specified mode, allows the GPIO wake sources to be determined at runtime. This function requires the GPIO wake sources to be defined at compile time in the board file.  <a href="group__micro.html#ga051d6e844d4db15cfc70f5bf62b496e6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__micro.html#gafddf1f4a9c9eff790d56c8950c1fb0ad">StStatus</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__micro.html#ga3373ba80e9c37170f3d9c00cc5ad4f60">halSleepForQsWithOptions</a> (<a class="el" href="group__iar.html#ga2ba8e0357fdc7b7a450e6893ed81e8e3">int32u</a> *duration, <a class="el" href="group__iar.html#ga2ba8e0357fdc7b7a450e6893ed81e8e3">int32u</a> gpioWakeBitMask)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Uses the system timer to enter <a class="el" href="group__micro.html#gga0411cd49bb5b71852cecd93bcbf0ca2da93af1c45a33be62df00d0ab82ef04128">SLEEPMODE_WAKETIMER</a> for approximately the specified amount of time (provided in quarter seconds), the GPIO wake sources can be provided at runtime.  <a href="group__micro.html#ga3373ba80e9c37170f3d9c00cc5ad4f60"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__micro.html#gafd32b37fdc20677e9f65bfca3281b7ba">halInternalIdleSleep</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Provides access to assembly code which triggers idle sleep.  <a href="group__micro.html#gafd32b37fdc20677e9f65bfca3281b7ba"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__micro.html#ga07522d6e2cb2d9da06d648289519c4ea">halInternalSleep</a> (<a class="el" href="group__micro.html#gaf1ad4bf3c523627d4b6f730b2e667968">SleepModes</a> sleepMode)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Puts the microcontroller to sleep in a specified mode. This internal function performs the actual sleep operation. This function assumes all of the wake source registers are configured properly.  <a href="group__micro.html#ga07522d6e2cb2d9da06d648289519c4ea"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__iar.html#ga2ba8e0357fdc7b7a450e6893ed81e8e3">int32u</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__micro.html#gaa901ac9f71208743801ed4598461276a">halGetWakeInfo</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Obtains the events that caused the last wake from sleep. The meaning of each bit is as follows:</p>
<ul>
<li>[31] = WakeInfoValid</li>
<li>[30] = SleepSkipped</li>
<li>[29] = CSYSPWRUPREQ</li>
<li>[28] = CDBGPWRUPREQ</li>
<li>[27] = PWRUP_WAKECORE</li>
<li>[26] = PWRUP_SLEEPTMRWRAP</li>
<li>[25] = PWRUP_SLEEPTMRCOMPB</li>
<li>[24] = PWRUP_SLEEPTMRCOMPA</li>
<li>[23:0] = corresponding GPIO activity. </li>
</ul>
 <a href="group__micro.html#gaa901ac9f71208743801ed4598461276a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__micro.html#gaa085fe2bf69f679edbb371bfcd91ad86">halCommonSeedRandom</a> (<a class="el" href="group__iar.html#ga2ba8e0357fdc7b7a450e6893ed81e8e3">int32u</a> seed)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Seeds the <a class="el" href="group__micro.html#ga92d978a2b55bcb6d8ffe996e9a768f57" title="Runs a standard LFSR to generate pseudorandom numbers.">halCommonGetRandom()</a> pseudorandom number generator.  <a href="group__micro.html#gaa085fe2bf69f679edbb371bfcd91ad86"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__iar.html#ga409a5c4bea6981c30b308684efa33f6f">int16u</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__micro.html#ga92d978a2b55bcb6d8ffe996e9a768f57">halCommonGetRandom</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Runs a standard LFSR to generate pseudorandom numbers.  <a href="group__micro.html#ga92d978a2b55bcb6d8ffe996e9a768f57"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Utility and convenience functions for STM32W108 microcontroller, common to both the full and minimal hal. See <a class="el" href="group__micro.html">Micro</a> for documentation. </p>

<p>Definition in file <a class="el" href="cortexm3_2micro-common_8h_source.html">cortexm3/micro-common.h</a>.</p>
</div>
<hr size="1">

<table border="0" cellspacing="0" cellpadding="0" width=100%>

<tr>

<td><address><small>

Hardware Abstraction Layer. <br>

1.0.1.

</small></address>

</td>

<td align="right">

<address><small>

Copyright &copy; 2009 by STMicrolectronics. All rights reserved.<br>

Generated Wed Sep 1 13:42:06 2010 with <a href="http://www.doxygen.org/index.html">Doxygen</a> 1.6.1.

</small></address>

</td>

</tr>

</table>

</body>

</html>
