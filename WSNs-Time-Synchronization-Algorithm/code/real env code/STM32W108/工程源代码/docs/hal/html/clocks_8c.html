<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">

<title>Hardware Abstraction Layer: clocks.c File Reference</title>

<LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">

</head><body>

<table border="0" cellspacing="0" cellpadding="0"  width=100%>

<tr>

<td><img src="ST_Logo.gif"></td>

<td> <div class="qindex">

<a class="qindex" href="index.html">Home</a>&nbsp;

 | &nbsp;<a class="qindex" href="modules.html">Modules</a>&nbsp;

 | &nbsp;<a class="qindex" href="annotated.html">Data Structures</a>&nbsp;

 | &nbsp;<a class="qindex" href="files.html">File List</a>&nbsp;

 | &nbsp;<a class="qindex" href="globals.html">Index</a></div>

</td>

</table>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>clocks.c File Reference</h1><code>#include &quot;<a class="el" href="error_8h_source.html">error.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="hal_8h_source.html">hal/hal.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="mpu_8h_source.html">hal/micro/cortexm3/mpu.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="mfg-token_8h_source.html">hal/micro/cortexm3/mfg-token.h</a>&quot;</code><br/>

<p><a href="clocks_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="clocks_8c.html#a8b56e6ec109adbbaa921d1112d0937d6">CALDBG</a>(x)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="clocks_8c.html#af7f633e6a5d9f1a398e95dc1426330b4">SLOWRC_PERIOD_SETTLE_TIME</a>&nbsp;&nbsp;&nbsp;4250</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="clocks_8c.html#ad67b110dd1e253ea6d10118060f45628">SLOWRC_PERIOD_SAMPLES</a>&nbsp;&nbsp;&nbsp;8</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="clocks_8c.html#a387085d70ed502a1a13c193868244f2a">CLK1K_NUMERATOR</a>&nbsp;&nbsp;&nbsp;384000000</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="clocks_8c.html#a69c629fe90fcf4344a62ba21b8ceb486">FASTRC_PERIOD_SETTLE_TIME</a>&nbsp;&nbsp;&nbsp;128</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="clocks_8c.html#aa08a6c898c336b0dc6160e0fcddf6ad2">OSC24M_BIASTRIM_OFFSET</a>&nbsp;&nbsp;&nbsp;(0x2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="clocks_8c.html#af119d218e9c71ad1586896f89e867eba">OSC24M_BIASTRIM_MIN</a>&nbsp;&nbsp;&nbsp;(0+OSC24M_BIASTRIM_OFFSET)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="clocks_8c.html#ab3000f207320807ab90aeb32be060a9e">OSC24M_BIASTRIM_MAX</a>&nbsp;&nbsp;&nbsp;OSC24M_BIASTRIM_OSC24M_BIAS_TRIM_MASK</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="clocks_8c.html#a850474ab5a588235a15a0b391a7f03e1">OSC24M_BIASTRIM_MSB</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; (OSC24M_BIASTRIM_OSC24M_BIAS_TRIM_BITS-1))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="clocks_8c.html#a2fd10fa8f5642167a358cca0cc43811a">OSC24M_BIASTRIM_UNINIT</a>&nbsp;&nbsp;&nbsp;(0xFFFF)</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__micro.html#ga4173faf01f05eb52ca815bec94193818">halInternalCalibrateSlowRc</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calibrates the internal SlowRC to generate a 1024 Hz (1kHz) clock.  <a href="group__micro.html#ga4173faf01f05eb52ca815bec94193818"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__micro.html#gad9b2f11a69544770078feaa71b6a3d0d">halInternalCalibrateFastRc</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calibrates the internal FastRC to generate a 12Mhz clock.  <a href="group__micro.html#gad9b2f11a69544770078feaa71b6a3d0d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__micro.html#ga35ddce6a5df4800dd1980735c59c6b2c">halCommonCheckXtalBiasTrim</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function is intended to be called periodically, from the stack and application, to check the XTAL bias trim is within appropriate levels and adjust if not. This function is *not* designed to be used before <a class="el" href="group__micro.html#gae47dcfa6256c2dd58e2a451e6b1411c6" title="Switches to running off of the 24MHz crystal, including changing the CPU to be 24MHz...">halInternalSwitchToXtal()</a> has been called.  <a href="group__micro.html#ga35ddce6a5df4800dd1980735c59c6b2c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__micro.html#gaebd4d106a0a42931460824b959ac32ee">halInternalSearchForBiasTrim</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Search for optimal 24MHz crystal bias trim, assuming no valid prior value. This function is typically called during initialization of the microcontroller.  <a href="group__micro.html#gaebd4d106a0a42931460824b959ac32ee"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__micro.html#gae47dcfa6256c2dd58e2a451e6b1411c6">halInternalSwitchToXtal</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Switches to running off of the 24MHz crystal, including changing the CPU to be 24MHz (FCLK sourced from SYSCLK). The switch function will respect the BIASTRIM HI and LO flags and adjust bias trim until appropriate crystal biasing is used. This function is called from within the stack and HAL at appropriate times.  <a href="group__micro.html#gae47dcfa6256c2dd58e2a451e6b1411c6"></a><br/></td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="token-manufacturing_8h.html#a9b178aaea4427651f96bd05c47f78101">tokTypeMfgOsc24mBiasTrim</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="clocks_8c.html#a872cfca4ce204448931bc7e932579d34">biasTrim</a> = OSC24M_BIASTRIM_UNINIT</td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a8b56e6ec109adbbaa921d1112d0937d6"></a><!-- doxytag: member="clocks.c::CALDBG" ref="a8b56e6ec109adbbaa921d1112d0937d6" args="(x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CALDBG</td>
          <td>(</td>
          <td class="paramtype">x&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="clocks_8c_source.html#l00020">20</a> of file <a class="el" href="clocks_8c_source.html">clocks.c</a>.</p>

</div>
</div>
<a class="anchor" id="a387085d70ed502a1a13c193868244f2a"></a><!-- doxytag: member="clocks.c::CLK1K_NUMERATOR" ref="a387085d70ed502a1a13c193868244f2a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CLK1K_NUMERATOR&nbsp;&nbsp;&nbsp;384000000</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="clocks_8c_source.html#l00059">59</a> of file <a class="el" href="clocks_8c_source.html">clocks.c</a>.</p>

</div>
</div>
<a class="anchor" id="a69c629fe90fcf4344a62ba21b8ceb486"></a><!-- doxytag: member="clocks.c::FASTRC_PERIOD_SETTLE_TIME" ref="a69c629fe90fcf4344a62ba21b8ceb486" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FASTRC_PERIOD_SETTLE_TIME&nbsp;&nbsp;&nbsp;128</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="clocks_8c_source.html#l00162">162</a> of file <a class="el" href="clocks_8c_source.html">clocks.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab3000f207320807ab90aeb32be060a9e"></a><!-- doxytag: member="clocks.c::OSC24M_BIASTRIM_MAX" ref="ab3000f207320807ab90aeb32be060a9e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OSC24M_BIASTRIM_MAX&nbsp;&nbsp;&nbsp;OSC24M_BIASTRIM_OSC24M_BIAS_TRIM_MASK</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="clocks_8c_source.html#l00263">263</a> of file <a class="el" href="clocks_8c_source.html">clocks.c</a>.</p>

</div>
</div>
<a class="anchor" id="af119d218e9c71ad1586896f89e867eba"></a><!-- doxytag: member="clocks.c::OSC24M_BIASTRIM_MIN" ref="af119d218e9c71ad1586896f89e867eba" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OSC24M_BIASTRIM_MIN&nbsp;&nbsp;&nbsp;(0+OSC24M_BIASTRIM_OFFSET)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="clocks_8c_source.html#l00262">262</a> of file <a class="el" href="clocks_8c_source.html">clocks.c</a>.</p>

</div>
</div>
<a class="anchor" id="a850474ab5a588235a15a0b391a7f03e1"></a><!-- doxytag: member="clocks.c::OSC24M_BIASTRIM_MSB" ref="a850474ab5a588235a15a0b391a7f03e1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OSC24M_BIASTRIM_MSB&nbsp;&nbsp;&nbsp;(1 &lt;&lt; (OSC24M_BIASTRIM_OSC24M_BIAS_TRIM_BITS-1))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="clocks_8c_source.html#l00264">264</a> of file <a class="el" href="clocks_8c_source.html">clocks.c</a>.</p>

</div>
</div>
<a class="anchor" id="aa08a6c898c336b0dc6160e0fcddf6ad2"></a><!-- doxytag: member="clocks.c::OSC24M_BIASTRIM_OFFSET" ref="aa08a6c898c336b0dc6160e0fcddf6ad2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OSC24M_BIASTRIM_OFFSET&nbsp;&nbsp;&nbsp;(0x2)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="clocks_8c_source.html#l00261">261</a> of file <a class="el" href="clocks_8c_source.html">clocks.c</a>.</p>

</div>
</div>
<a class="anchor" id="a2fd10fa8f5642167a358cca0cc43811a"></a><!-- doxytag: member="clocks.c::OSC24M_BIASTRIM_UNINIT" ref="a2fd10fa8f5642167a358cca0cc43811a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OSC24M_BIASTRIM_UNINIT&nbsp;&nbsp;&nbsp;(0xFFFF)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="clocks_8c_source.html#l00265">265</a> of file <a class="el" href="clocks_8c_source.html">clocks.c</a>.</p>

</div>
</div>
<a class="anchor" id="ad67b110dd1e253ea6d10118060f45628"></a><!-- doxytag: member="clocks.c::SLOWRC_PERIOD_SAMPLES" ref="ad67b110dd1e253ea6d10118060f45628" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SLOWRC_PERIOD_SAMPLES&nbsp;&nbsp;&nbsp;8</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="clocks_8c_source.html#l00038">38</a> of file <a class="el" href="clocks_8c_source.html">clocks.c</a>.</p>

</div>
</div>
<a class="anchor" id="af7f633e6a5d9f1a398e95dc1426330b4"></a><!-- doxytag: member="clocks.c::SLOWRC_PERIOD_SETTLE_TIME" ref="af7f633e6a5d9f1a398e95dc1426330b4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SLOWRC_PERIOD_SETTLE_TIME&nbsp;&nbsp;&nbsp;4250</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="clocks_8c_source.html#l00028">28</a> of file <a class="el" href="clocks_8c_source.html">clocks.c</a>.</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a872cfca4ce204448931bc7e932579d34"></a><!-- doxytag: member="clocks.c::biasTrim" ref="a872cfca4ce204448931bc7e932579d34" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="token-manufacturing_8h.html#a9b178aaea4427651f96bd05c47f78101">tokTypeMfgOsc24mBiasTrim</a> <a class="el" href="clocks_8c.html#a872cfca4ce204448931bc7e932579d34">biasTrim</a> = OSC24M_BIASTRIM_UNINIT</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="clocks_8c_source.html#l00266">266</a> of file <a class="el" href="clocks_8c_source.html">clocks.c</a>.</p>

</div>
</div>
</div>
<hr size="1">

<table border="0" cellspacing="0" cellpadding="0" width=100%>

<tr>

<td><address><small>

Hardware Abstraction Layer. <br>

1.0.1.

</small></address>

</td>

<td align="right">

<address><small>

Copyright &copy; 2009 by STMicrolectronics. All rights reserved.<br>

Generated Wed Sep 1 13:42:02 2010 with <a href="http://www.doxygen.org/index.html">Doxygen</a> 1.6.1.

</small></address>

</td>

</tr>

</table>

</body>

</html>
